import os


'''url_set=[
    "https://arxiv.org/abs/2208.11970",
    "https://arxiv.org/abs/2101.03288",
    "https://arxiv.org/abs/2209.04747",
    "https://arxiv.org/abs/2209.02646",
    "https://arxiv.org/abs/2209.00796",
    "https://arxiv.org/abs/2209.08725",
    "https://arxiv.org/abs/2209.08256",
    "https://arxiv.org/abs/2209.05557",
    "https://arxiv.org/abs/2209.05442",
    "https://arxiv.org/abs/2209.04439",
    "https://arxiv.org/abs/2208.14699",
    "https://arxiv.org/abs/2208.13753",
    "https://arxiv.org/abs/2208.09392",
    "https://arxiv.org/abs/2208.08664",
    "https://arxiv.org/abs/2208.07791",
    "https://arxiv.org/abs/2208.07131",
    "https://arxiv.org/abs/2208.04202",
    "https://arxiv.org/abs/2208.01864",
    "https://arxiv.org/abs/2207.11192",
    "https://arxiv.org/abs/2207.04316",
    "https://arxiv.org/abs/2207.02196",
    "https://arxiv.org/abs/2206.14464",
    "https://arxiv.org/abs/2206.11474",
    "https://arxiv.org/abs/2206.13397",
    "https://arxiv.org/abs/2206.09012",
    "https://arxiv.org/abs/2206.10365",
    "https://arxiv.org/abs/2206.08889",
    "https://arxiv.org/abs/2206.08265",
    "https://arxiv.org/abs/2206.07309",
    "https://arxiv.org/abs/2206.07771",
    "https://arxiv.org/abs/2206.05564",
    "https://arxiv.org/abs/2206.05173",
    "https://arxiv.org/abs/2206.05039",
    "https://arxiv.org/abs/2206.04029",
    "https://arxiv.org/abs/2206.02262",
    "https://arxiv.org/abs/2206.00927",
    "https://arxiv.org/abs/2206.00364",
    "https://arxiv.org/abs/2206.00070",
    "https://arxiv.org/abs/2205.15463",
    "https://arxiv.org/abs/2205.14987",
    "https://arxiv.org/abs/2205.13699",
    "https://arxiv.org/abs/2205.12524",
    "https://arxiv.org/abs/2205.03859",
    "https://arxiv.org/abs/2205.01490",
    "https://arxiv.org/abs/2204.13902",
    "https://arxiv.org/abs/2204.11824",
    "https://arxiv.org/abs/2204.00227",
    "https://arxiv.org/abs/2203.17260",
    "https://arxiv.org/abs/2203.15636",
    "https://arxiv.org/abs/2203.14206",
    "https://arxiv.org/abs/2203.04304",
    "https://arxiv.org/abs/2202.13460",
    "https://arxiv.org/abs/2202.10166",
    "https://arxiv.org/abs/2202.09778",
    "https://arxiv.org/abs/2202.09671",
    "https://arxiv.org/abs/2202.07477",
    "https://arxiv.org/abs/2202.05830",
    "https://arxiv.org/abs/2202.00512",
    "https://arxiv.org/abs/2201.06503",
    "https://arxiv.org/abs/2201.00308",
    "https://arxiv.org/abs/2112.13339",
    "https://arxiv.org/abs/2112.10741",
    "https://arxiv.org/abs/2112.10752",
    "https://arxiv.org/abs/2112.09788",
    "https://arxiv.org/abs/2112.09164",
    "https://arxiv.org/abs/2112.07804",
    "https://arxiv.org/abs/2112.07068",
    "https://arxiv.org/abs/2112.05744",
    "https://arxiv.org/abs/2112.01799",
    "https://arxiv.org/abs/2111.15640",
    "https://arxiv.org/abs/2111.13606",
    "https://arxiv.org/abs/2111.12701",
    "https://arxiv.org/abs/2110.07579",
    "https://arxiv.org/abs/2110.05948",
    "https://arxiv.org/abs/2110.03237",
    "https://arxiv.org/abs/2110.00473",
    "https://arxiv.org/abs/2207.12598",
    "https://arxiv.org/abs/2108.11514",
    "https://arxiv.org/abs/2108.08827",
    "https://arxiv.org/abs/2108.02938",
    "https://arxiv.org/abs/2108.01073",
    "https://arxiv.org/abs/2107.03006",
    "https://arxiv.org/abs/2107.00630",
    "https://arxiv.org/abs/2106.15671",
    "https://arxiv.org/abs/2106.10410",
    "https://arxiv.org/abs/2106.07582",
    "https://arxiv.org/abs/2106.06819",
    "https://arxiv.org/abs/2106.05931",
    "https://arxiv.org/abs/2106.03802",
    "https://arxiv.org/abs/2106.02808",
    "https://arxiv.org/abs/2106.01357",
    "https://arxiv.org/abs/2106.00132",
    "https://arxiv.org/abs/2106.15282",
    "https://arxiv.org/abs/2105.14080",
    "https://arxiv.org/abs/2105.05233",
    "https://arxiv.org/abs/2104.07636",
    "https://arxiv.org/abs/2104.02600",
    "https://arxiv.org/abs/2102.09672",
    "https://arxiv.org/abs/2101.09258",
    "https://arxiv.org/abs/2101.02388",
    "https://arxiv.org/abs/2012.08125",
    "https://arxiv.org/abs/2011.13456",
    "https://arxiv.org/abs/2010.08258",
    "https://arxiv.org/abs/2010.02502",
    "https://arxiv.org/abs/2009.05475",
    "https://arxiv.org/abs/2006.11239",
    "https://arxiv.org/abs/2006.09011",
    "https://arxiv.org/abs/1907.05600",
    "https://arxiv.org/abs/1905.09883",
    "https://arxiv.org/abs/1503.03585",
    "https://arxiv.org/abs/2209.08256",
    "https://arxiv.org/abs/2208.14699",
    "https://arxiv.org/abs/2207.00050",
    "https://arxiv.org/abs/2206.09012",
    "https://arxiv.org/abs/2205.11423",
    "https://arxiv.org/abs/2112.03145",
    "https://arxiv.org/abs/2112.03126",
    "https://arxiv.org/abs/2112.00390",
    "https://arxiv.org/abs/2209.08814",
    "https://arxiv.org/abs/2207.14626",
    "https://arxiv.org/abs/2207.09786",
    "https://arxiv.org/abs/2207.08208",
    "https://arxiv.org/abs/2207.06635",
    "https://arxiv.org/abs/2206.07771",
    "https://arxiv.org/abs/2206.04514",
    "https://arxiv.org/abs/2205.12952",
    "https://arxiv.org/abs/2205.07680",
    "https://arxiv.org/abs/2204.02641",
    "https://arxiv.org/abs/2203.08382",
    "https://arxiv.org/abs/2201.11793",
    "https://arxiv.org/abs/2112.05149",
    "https://arxiv.org/abs/2111.15640",
    "https://arxiv.org/abs/2111.13606",
    "https://arxiv.org/abs/2108.02938",
    "https://arxiv.org/abs/2104.05358",
    "https://arxiv.org/abs/2208.09392",
    "https://arxiv.org/abs/2207.09786",
    "https://arxiv.org/abs/2201.11793",
    "https://arxiv.org/abs/2201.00308",
    "https://arxiv.org/abs/2112.10752",
    "https://arxiv.org/abs/2112.05146",
    "https://arxiv.org/abs/2111.13606",
    "https://arxiv.org/abs/2111.04639",
    "https://arxiv.org/abs/2110.02037",
    "https://arxiv.org/abs/2108.02938",
    "https://arxiv.org/abs/2106.15282",
    "https://arxiv.org/abs/2104.14951",
    "https://arxiv.org/abs/2104.07636",
    "https://arxiv.org/abs/2209.08217",
    "https://arxiv.org/abs/2208.12675",
    "https://arxiv.org/abs/2208.09392",
    "https://arxiv.org/abs/2207.09786",
    "https://arxiv.org/abs/2206.02779",
    "https://arxiv.org/abs/2206.00941",
    "https://arxiv.org/abs/2206.00386",
    "https://arxiv.org/abs/2201.11793",
    "https://arxiv.org/abs/2201.09865",
    "https://arxiv.org/abs/2112.10752",
    "https://arxiv.org/abs/2112.07804",
    "https://arxiv.org/abs/2112.05146",
    "https://arxiv.org/abs/2111.13606",
    "https://arxiv.org/abs/2111.12701",
    "https://arxiv.org/abs/2108.02938",
    "https://arxiv.org/abs/2108.01073",
    "https://arxiv.org/abs/2209.08891",
    "https://arxiv.org/abs/2209.06970",
    "https://arxiv.org/abs/2208.12242",
    "https://arxiv.org/abs/2207.13038",
    "https://arxiv.org/abs/2206.07771",
    "https://arxiv.org/abs/2206.02779",
    "https://arxiv.org/abs/2206.01714",
    "https://arxiv.org/abs/2206.00386",
    "https://arxiv.org/abs/2205.16007",
    "https://arxiv.org/abs/2205.15996",
    "https://arxiv.org/abs/2205.11487",
    "https://arxiv.org/abs/2204.11824",
    "https://arxiv.org/abs/2204.06125",
    "https://arxiv.org/abs/2204.02849",
    "https://arxiv.org/abs/2112.05744",
    "https://arxiv.org/abs/2111.14822",
    "https://arxiv.org/abs/2111.14818",
    "https://arxiv.org/abs/2110.02711",
    "https://arxiv.org/abs/2209.07162",
    "https://arxiv.org/abs/2209.06167",
    "https://arxiv.org/abs/2209.00835",
    "https://arxiv.org/abs/2208.05481",
    "https://arxiv.org/abs/2207.12268",
    "https://arxiv.org/abs/2207.08208",
    "https://arxiv.org/abs/2207.05876",
    "https://arxiv.org/abs/2207.03430",
    "https://arxiv.org/abs/2206.13393",
    "https://arxiv.org/abs/2206.13295",
    "https://arxiv.org/abs/2206.03461",
    "https://arxiv.org/abs/2206.00941",
    "https://arxiv.org/abs/2204.02641",
    "https://arxiv.org/abs/2203.12621",
    "https://arxiv.org/abs/2203.04306",
    "https://arxiv.org/abs/2203.04292",
    "https://arxiv.org/abs/2203.03623",
    "https://arxiv.org/abs/2202.01479",
    "https://arxiv.org/abs/2201.11760",
    "https://arxiv.org/abs/2112.05146",
    "https://arxiv.org/abs/2111.08005",
    "https://arxiv.org/abs/2110.05243",
    "https://arxiv.org/abs/2206.07696",
    "https://arxiv.org/abs/2205.11495",
    "https://arxiv.org/abs/2205.09853",
    "https://arxiv.org/abs/2204.03458",
    "https://arxiv.org/abs/2203.09481",
    "https://arxiv.org/abs/2209.01170",
    "https://arxiv.org/abs/2208.14699",
    "https://arxiv.org/abs/2208.09801",
    "https://arxiv.org/abs/2112.03530",
    "https://arxiv.org/abs/2107.10981",
    "https://arxiv.org/abs/2104.03670",
    "https://arxiv.org/abs/2103.01458",
    "https://arxiv.org/abs/2208.04756",
    "https://arxiv.org/abs/2207.06389",
    "https://arxiv.org/abs/2206.06811",
    "https://arxiv.org/abs/2205.14807",
    "https://arxiv.org/abs/2204.09934",
    "https://arxiv.org/abs/2203.16749",
    "https://arxiv.org/abs/2203.13508",
    "https://arxiv.org/abs/2201.12519",
    "https://arxiv.org/abs/2112.13339",
    "https://arxiv.org/abs/2110.05948",
    "https://arxiv.org/abs/2107.00630",
    "https://arxiv.org/abs/2106.07431",
    "https://arxiv.org/abs/2106.06406",
    "https://arxiv.org/abs/2105.07583",
    "https://arxiv.org/abs/2105.02446",
    "https://arxiv.org/abs/2103.16091",
    "https://arxiv.org/abs/2009.09761",
    "https://arxiv.org/abs/2009.00713",
    "https://arxiv.org/abs/2105.13871",
    "https://arxiv.org/abs/2109.13821",
    "https://arxiv.org/abs/2208.05830",
    "https://arxiv.org/abs/2206.08545",
    "https://arxiv.org/abs/2206.03065",
    "https://arxiv.org/abs/2202.05256",
    "https://arxiv.org/abs/2107.11876",
    "https://arxiv.org/abs/2206.02246",
    "https://arxiv.org/abs/2104.11347",
    "https://arxiv.org/abs/2104.02321",
    "https://arxiv.org/abs/2207.09983",
    "https://arxiv.org/abs/2205.15370",
    "https://arxiv.org/abs/2202.03751",
    "https://arxiv.org/abs/2201.11972",
    "https://arxiv.org/abs/2111.11755",
    "https://arxiv.org/abs/2110.02584",
    "https://arxiv.org/abs/2106.09660",
    "https://arxiv.org/abs/2105.06337",
    "https://arxiv.org/abs/2105.02446",
    "https://arxiv.org/abs/2104.01409",
    "https://arxiv.org/abs/2208.09801",
    "https://arxiv.org/abs/2208.09801",
    "https://arxiv.org/abs/2207.08089",
    "https://arxiv.org/abs/2207.03442",
    "https://arxiv.org/abs/2206.10875",
    "https://arxiv.org/abs/2206.10550",
    "https://arxiv.org/abs/2205.14969",
    "https://arxiv.org/abs/2205.07460",
    "https://arxiv.org/abs/2112.10774",
    "https://arxiv.org/abs/2106.06041",
    "https://arxiv.org/abs/2206.05895",
    "https://arxiv.org/abs/2205.14217",
    "https://arxiv.org/abs/2111.01471",
    "https://arxiv.org/abs/2208.09399",
    "https://arxiv.org/abs/2107.03502",
    "https://arxiv.org/abs/2106.10121",
    "https://arxiv.org/abs/2101.12072",
    "https://arxiv.org/abs/2209.05710",
    "https://arxiv.org/abs/2209.00865",
    "https://arxiv.org/abs/2206.12159",
    "https://arxiv.org/abs/2206.11898",
    "https://arxiv.org/abs/2206.04119",
    "https://arxiv.org/abs/2206.01729",
    "https://arxiv.org/abs/2205.15019",
    "https://arxiv.org/abs/2204.08672",
    "https://arxiv.org/abs/2203.17003",
    "https://arxiv.org/abs/2203.02923",
    "https://arxiv.org/abs/2208.07949",
    "https://arxiv.org/abs/2208.05314",
    "https://arxiv.org/abs/2206.01729",
    "https://arxiv.org/abs/2202.02763",
    "https://arxiv.org/abs/2107.10072",
    "https://arxiv.org/abs/2209.10446",
    "https://arxiv.org/abs/2209.03855",
    "https://arxiv.org/abs/2209.02696",
    "https://arxiv.org/abs/2209.00349",
    "https://arxiv.org/abs/2208.15001",
    "https://arxiv.org/abs/2208.14125",
    "https://arxiv.org/abs/2208.11284",
    "https://arxiv.org/abs/2208.09141",
    "https://arxiv.org/abs/2208.09591",
    "https://arxiv.org/abs/2208.00542",
    "https://arxiv.org/abs/2207.14626",
    "https://arxiv.org/abs/2207.08000",
    "https://arxiv.org/abs/2206.11892",
    "https://arxiv.org/abs/2206.07771",
    "https://arxiv.org/abs/2206.07275",
    "https://arxiv.org/abs/2206.05408",
    "https://arxiv.org/abs/2206.03992",
    "https://arxiv.org/abs/2205.09991",
    "https://arxiv.org/abs/2203.13777",
    "https://arxiv.org/abs/2111.08177",
    "https://arxiv.org/abs/2111.05199",
    "https://arxiv.org/abs/2111.01713",
    "https://arxiv.org/abs/2110.06197",
    "https://arxiv.org/abs/2011.06704",
    "https://arxiv.org/abs/2003.00638"
]
for url in url_set:
    url.replace("abs","pdf")
    url=url+".pdf"
    print(url)
other_paper=["https://link.springer.com/chapter/10.1007/978-3-031-10989-8_47","https://proceedings.neurips.cc/paper/2021/hash/a45a1d12ee0fb7f1f872ab91da18f899-Abstract.html",
"https://openreview.net/forum?id=7DI6op61AY","https://openaccess.thecvf.com/content/CVPR2022W/NTIRE/papers/Wyatt_AnoDDPM_Anomaly_Detection_With_Denoising_Diffusion_Probabilistic_Models_Using_Simplex_CVPRW_2022_paper.pdf",
"http://www.iro.umontreal.ca/~vincentp/Publications/smdae_techreport.pdf","https://www.stats.ox.ac.uk/~teh/research/compstats/WelTeh2011a.pdf"]'''
import requests
from lxml import etree
import os
import time
import re
from multiprocessing.dummy import Pool

def getHtml(url):
    html = requests.get(url).content
    selector = etree.HTML(html)
    return selector

def getContent(htm, xpathStr):
    selector = htm
    content = selector.xpath(xpathStr)  
    return content

def getDownPdf(cons,count):
    pa = os.path.dirname(__file__) + '/' + 'arxiv/'
    # check and create folder
    if not os.path.exists(pa):
        os.mkdir(pa)
    count+=1
    fl = pa + str(count)+'.pdf'
    r = requests.get(cons)
    with open(fl, "wb") as code:
        code.write(r.content)

#### main ###
url0 = 'http://arxiv.org/list/cs.CV/recent'
print(url0)
# xpath of each page
xp1 = '//dl[1]//*[@class="list-identifier"]//a[2]//@href'  # pdf href list
xp2 = '//dl[1]//*[@class="list-title"]/text()'  # Title
xp_date = '//*[@id="dlpage"]/h3[1]/text()'  # date->folder

htm0 = getHtml(url0)
cons1 = getContent(htm0, xp1)  # get pdfs' href
cons2 = getContent(htm0, xp2)  # get papers' title
cons_date = getContent(htm0, xp_date) # get date

folder = cons_date[0].split(', ') # get date string

print(folder[1] + ': having %s' % len(cons1) + '  files')
print('pdfs are downloading...')
count=0
for indx in range(0, len(cons1)):
    href = 'http://arxiv.org' + cons1[indx]
    count+=1
    getDownPdf(href,count)